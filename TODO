
Makefile:
------------

* `arduino-cli board list` will list all attached boards.
  If BOARD is not set, parse this and get the attached board for the specified serial port.

* Get SAMD51 ARM compiling.
/home/aaron/.arduino15/packages/adafruit/tools/arm-none-eabi-gcc/9-2019q4/bin/arm-none-eabi-g++

    -mcpu=cortex-m4s
    -mthumb 
OK    -c -g -Os 
    -Werror=return-type  # (Seems strictly optional to me.)
OK    -std=gnu++11  # (I use gnu++14, but OK.)
OK    -ffunction-sections -fdata-sections -fno-threadsafe-statics 
    -nostdlib --param max-inline-insns-single=500 -fno-rtti
OK    -fno-exceptions 

    "-D__SKETCH_NAME__=\"\"\"dual-blink.ino\"\"\"" 

OK    -DF_CPU=120000000L
    -DARDUINO=10816 
OK    -DARDUINO_FEATHER_M4
    -DARDUINO_ARCH_SAMD -DARDUINO_SAMD_ADAFRUIT -D__SAMD51J19A__
    -DADAFRUIT_FEATHER_M4_EXPRESS -D__SAMD51__ 
    -D__FPU_PRESENT -DARM_MATH_CM4 -mfloat-abi=hard
    -mfpu=fpv4-sp-d16 
OK    -DUSB_VID=0x239A -DUSB_PID=0x8022
    -DUSBCON -DUSB_CONFIG_POWER=100
    "-DUSB_MANUFACTURER=\"Adafruit\"" 
    "-DUSB_PRODUCT=\"Feather M4 Express\"" ### (Captured but needs quotes.)

    -I/home/aaron/.arduino15/packages/adafruit/hardware/samd/1.7.8/libraries/Adafruit_TinyUSB_Arduino/src/arduino
    -DENABLE_CACHE -DVARIANT_QSPI_BAUD_DEFAULT=50000000 
    
    -I/home/aaron/.arduino15/packages/adafruit/hardware/samd/1.7.8/libraries/Adafruit_TinyUSB_Arduino/src/arduino
    -I/home/aaron/.arduino15/packages/adafruit/tools/CMSIS/5.4.0/CMSIS/Core/Include/
    -I/home/aaron/.arduino15/packages/adafruit/tools/CMSIS/5.4.0/CMSIS/DSP/Include/
    -I/home/aaron/.arduino15/packages/adafruit/tools/CMSIS-Atmel/1.2.2/CMSIS/Device/ATMEL/
OK    -I/home/aaron/.arduino15/packages/adafruit/hardware/samd/1.7.8/cores/arduino
    -I/home/aaron/.arduino15/packages/adafruit/hardware/samd/1.7.8/variants/feather_m4 ##(ALMOST?)

    foo.cpp -o foo.o


* Upload with bossac, not avrdude:
  /home/aaron/.arduino15/packages/arduino/tools/bossac/1.9.1-arduino2/bossac -i -d --port=ttyACM0 \
    -U -i --offset=0x4000 -w -v /tmp/arduino_build_683375/dual-blink.ino.bin -R 


Debugger:
------------

On-device service capabilities:

Client:

  * Use `arduino-cli board list` to autodetect the attached board for the specified serial port.

  --------

  * Can we implement a 'setlocal' ?
    * Would need to use call frame info to determine where on the stack it lives...
      or where on the stack frame above the local the register got saved.
    * This would be very tricky for frames below #0; especially if the register is live/implicit
      in the current frame, it could make the current frame have undefined behavior. If it was
      pushed on the stack but not in frame 'n-1' then it could cause undefined behavior in that
      intermediate frame.

  * types.py should handle union type? bit fields?
  * Filter __dbg_service and __vector17 out of stack trace report and `frame` commands?

  * add notion of "current frame" that can be adjusted rather than just as immediate arg
    to `frame` / `\f`, locals, etc?

  * Optionally embed ELF file in core dump file, for all-in-one dump file w/o separate .elf.

SAM D21 support: (See Cortex-M0+ Technical Reference Manual)
* Breakpoint unit support
* Watchpoint unit support
* Single-step support
* ... cleaner backtrace via ARM-standard frame pointer record walking.


